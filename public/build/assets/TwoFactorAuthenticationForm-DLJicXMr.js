var W=Object.defineProperty;var Y=(o,e,t)=>e in o?W(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var l=(o,e,t)=>Y(o,typeof e!="symbol"?e+"":e,t);import{C as R,q as p,o as n,f as h,a as y,k as H,b as s,w as r,m as f,t as C,ax as q,l as w,ay as G,x as K,c as u,p as z,F as E}from"./app-55nQHNrK.js";import{A as J}from"./ActionSection-DnR7S2V-.js";import{C as I,t as O,V as D,d as $,b as X,a as c,_ as B,c as Z}from"./_plugin-vue_export-helper-BkxQ5w1y.js";import{V as M}from"./VDialog-BDRwFbH1.js";import{V as F,b as N,a as b,c as j}from"./VCard-OJ0p7aro.js";import{V as A}from"./VTextField-HiXiHTac.js";import{I as _,V as T}from"./InputError-BX8IdEyR.js";import{V as Q,a as U}from"./VRow-Du34Hmus.js";import"./SectionTitle-BvMKXVsc.js";import"./VContainer-G3jeVjVC.js";/* empty css              */import"./VAvatar-DmRN7j2J.js";import"./VOverlay-Dck7tMSy.js";import"./forwardRefs-B931MWyl.js";import"./VField-3MKmkEWW.js";import"./index-qS4-Yaju.js";var x=Object.defineProperty,oo=Object.getOwnPropertyDescriptor,P=(o,e,t,a)=>{for(var i=a>1?void 0:a?oo(e,t):e,m=o.length-1,d;m>=0;m--)(d=o[m])&&(i=(a?d(e,t,i):d(i))||i);return a&&i&&x(e,t,i),i};let g=class extends D{constructor(){super(...arguments);l(this,"title");l(this,"content");l(this,"button");l(this,"confirmingPassword",!1);l(this,"form",R({password:"",error:"",processing:!1}));l(this,"passwordInput")}async startConfirmingPassword(){(await p.get(route("password.confirmation"))).data.confirmed?this.$emit("confirmed"):(this.confirmingPassword=!0,setTimeout(()=>{var t;return(t=this.passwordInput)==null?void 0:t.focus()},250))}async confirmPassword(){this.form.processing=!0;try{await p.post(route("password.confirm"),{password:this.form.password}),this.form.processing=!1,this.closeModal(),this.$nextTick(()=>this.$emit("confirmed"))}catch(e){this.form.processing=!1,this.form.error=e.response.data.errors.password[0],this.passwordInput.focus()}}closeModal(){this.confirmingPassword=!1,this.form.password="",this.form.error=""}};P([$({type:String,default:"Confirm Password"})],g.prototype,"title",2);P([$({type:String,default:"For your security, please confirm your password to continue."})],g.prototype,"content",2);P([$({type:String,default:"Confirm"})],g.prototype,"button",2);P([X("passwordInput")],g.prototype,"passwordInput",2);g=P([I({components:{VDialog:M,VCard:F,VCardTitle:N,VCardText:b,VCardActions:j,VTextField:A,VBtn:c}})],g);const eo=O(g),to={key:0,class:"text-error mt-2"};function ro(o,e,t,a,i,m){return n(),h("span",null,[y("span",{onClick:e[0]||(e[0]=(...d)=>o.startConfirmingPassword&&o.startConfirmingPassword(...d))},[H(o.$slots,"default")]),s(M,{modelValue:o.confirmingPassword,"onUpdate:modelValue":e[2]||(e[2]=d=>o.confirmingPassword=d),persistent:"","max-width":"400px"},{default:r(()=>[s(F,null,{default:r(()=>[s(N,null,{default:r(()=>[f(C(o.title),1)]),_:1}),s(b,null,{default:r(()=>[f(C(o.content)+" ",1),s(A,{ref:"passwordInput",modelValue:o.form.password,"onUpdate:modelValue":e[1]||(e[1]=d=>o.form.password=d),type:"password",class:"mt-4",placeholder:"Password",autocomplete:"current-password",onKeyup:q(o.confirmPassword,["enter"]),variant:"outlined"},null,8,["modelValue","onKeyup"]),o.form.error?(n(),h("p",to,C(o.form.error),1)):w("",!0)]),_:1}),s(j,null,{default:r(()=>[s(c,{variant:"text",onClick:o.closeModal},{default:r(()=>e[3]||(e[3]=[f("Cancel")])),_:1},8,["onClick"]),s(c,{color:"primary",variant:"elevated",loading:o.form.processing,onClick:o.confirmPassword},{default:r(()=>[f(C(o.button),1)]),_:1},8,["loading","onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const no=B(eo,[["render",ro]]);var so=Object.defineProperty,ao=Object.getOwnPropertyDescriptor,S=(o,e,t,a)=>{for(var i=a>1?void 0:a?ao(e,t):e,m=o.length-1,d;m>=0;m--)(d=o[m])&&(i=(a?d(e,t,i):d(i))||i);return a&&i&&so(e,t,i),i};let V=class extends D{constructor(){super(...arguments);l(this,"requiresConfirmation");l(this,"page",G());l(this,"enabling",!1);l(this,"confirming",!1);l(this,"disabling",!1);l(this,"qrCode",null);l(this,"setupKey",null);l(this,"recoveryCodes",[]);l(this,"confirmationForm",R({code:""}))}get twoFactorEnabled(){var t;return!this.enabling&&((t=this.page.props.auth.user)==null?void 0:t.two_factor_enabled)}twoFactorEnabledWatcher(t,a){t||(this.confirmationForm.reset(),this.confirmationForm.clearErrors())}async enableTwoFactorAuthentication(){this.enabling.value=!0;try{let t=await p.post(route("two-factor.enable"));await this.showQrCode(),await this.showSetupKey(),await this.showRecoveryCodes()}finally{this.enabling=!1,this.confirming=this.requiresConfirmation}}async showQrCode(){return await p.get(route("two-factor.qr-code")).then(t=>{this.qrCode=t.data.svg})}async showSetupKey(){return await p.get(route("two-factor.secret-key")).then(t=>{this.setupKey=t.data.secretKey})}async showRecoveryCodes(){return await p.get(route("two-factor.recovery-codes")).then(t=>{this.recoveryCodes=t.data})}async confirmTwoFactorAuthentication(){var t;try{let a=await p.post(route("two-factor.confirm"),this.confirmationForm);this.confirming=!1,this.qrCode=null,this.setupKey=null}catch(a){((t=a.response)==null?void 0:t.status)===422?this.confirmationForm.errors=a.response.data.errors:console.error("Unexpected error:",a)}}async regenerateRecoveryCodes(){await p.post(route("two-factor.confirm")),this.showRecoveryCodes()}async disableTwoFactorAuthentication(){this.disabling=!0,await p.delete(route("two-factor.disable")),this.disabling=!1,this.confirming=!1}};S([$(Boolean)],V.prototype,"requiresConfirmation",2);S([Z("twoFactorEnabled")],V.prototype,"twoFactorEnabledWatcher",1);V=S([I({components:{ActionSection:J,InputError:_,ConfirmsPassword:no,VRow:Q,VCol:U,VTextField:A,VBtn:c,VAlert:T,VCard:F,VCardText:b}})],V);const io=O(V),lo={key:0},uo={key:1},fo=["innerHTML"],mo={class:"bg-gray-100 dark:bg-gray-900 rounded-lg pa-4"},po={class:"mt-5"};function co(o,e,t,a,i,m){const d=K("InputError"),v=K("ConfirmsPassword"),L=K("ActionSection");return n(),u(L,null,{title:r(()=>e[1]||(e[1]=[f("Two Factor Authentication")])),description:r(()=>e[2]||(e[2]=[f("Add additional security to your account.")])),content:r(()=>[o.twoFactorEnabled&&!o.confirming?(n(),u(T,{key:0,type:"success",title:"You have enabled two-factor authentication."})):o.twoFactorEnabled&&o.confirming?(n(),u(T,{key:1,type:"info",title:"Finish enabling two-factor authentication."})):(n(),u(T,{key:2,type:"warning",title:"You have not enabled two-factor authentication."})),e[10]||(e[10]=y("p",{class:"text-body-1 mt-2 mb-2"}," When two factor authentication is enabled, you will be prompted for a secure, random token during authentication. You may retrieve this token from your phone's Google Authenticator application. ",-1)),o.qrCode?(n(),u(F,{key:3,class:"mt-4 pa-4"},{default:r(()=>[s(b,null,{default:r(()=>[o.confirming?(n(),h("p",lo," To finish enabling two-factor authentication, scan the QR code using your authenticator app or enter the setup key. ")):(n(),h("p",uo,"Two-factor authentication is now enabled. Scan the QR code or enter the setup key."))]),_:1}),y("div",{class:"text-center",innerHTML:o.qrCode},null,8,fo),o.setupKey?(n(),u(b,{key:0},{default:r(()=>[e[3]||(e[3]=y("strong",null,"Setup Key:",-1)),f(" "+C(o.setupKey),1)]),_:1})):w("",!0),o.confirming?(n(),u(Q,{key:1,class:"mt-4"},{default:r(()=>[s(U,{cols:"12"},{default:r(()=>[s(A,{modelValue:o.confirmationForm.code,"onUpdate:modelValue":e[0]||(e[0]=k=>o.confirmationForm.code=k),label:"Code",autofocus:"",onKeyup:q(o.confirmTwoFactorAuthentication,["enter"])},null,8,["modelValue","onKeyup"]),s(d,{message:o.confirmationForm.errors.code},null,8,["message"])]),_:1})]),_:1})):w("",!0)]),_:1})):w("",!0),o.recoveryCodes.length>0&&!o.confirming?(n(),u(F,{key:4,class:"mt-4 pa-4"},{default:r(()=>[s(b,null,{default:r(()=>[e[4]||(e[4]=y("p",null,"Store these recovery codes safely. They help regain access if you lose your authentication device.",-1)),y("div",mo,[(n(!0),h(E,null,z(o.recoveryCodes,k=>(n(),h("div",{key:k},C(k),1))),128))])]),_:1})]),_:1})):w("",!0),y("div",po,[o.twoFactorEnabled?(n(),h(E,{key:1},[o.confirming?(n(),u(v,{key:0,onConfirmed:o.confirmTwoFactorAuthentication},{default:r(()=>[s(c,{color:"primary",class:"me-3",disabled:o.enabling},{default:r(()=>e[6]||(e[6]=[f("Confirm")])),_:1},8,["disabled"])]),_:1},8,["onConfirmed"])):w("",!0),o.recoveryCodes.length>0&&!o.confirming?(n(),u(v,{key:1,onConfirmed:o.regenerateRecoveryCodes},{default:r(()=>[s(c,{class:"me-3"},{default:r(()=>e[7]||(e[7]=[f("Regenerate Recovery Codes")])),_:1})]),_:1},8,["onConfirmed"])):w("",!0),o.recoveryCodes.length===0&&!o.confirming?(n(),u(v,{key:2,onConfirmed:o.showRecoveryCodes},{default:r(()=>[s(c,{class:"me-3"},{default:r(()=>e[8]||(e[8]=[f("Show Recovery Codes")])),_:1})]),_:1},8,["onConfirmed"])):w("",!0),s(v,{onConfirmed:o.disableTwoFactorAuthentication},{default:r(()=>[s(c,{color:"error",disabled:o.disabling},{default:r(()=>e[9]||(e[9]=[f("Disable")])),_:1},8,["disabled"])]),_:1},8,["onConfirmed"])],64)):(n(),u(v,{key:0,onConfirmed:o.enableTwoFactorAuthentication},{default:r(()=>[s(c,{color:"primary",variant:"elevated",disabled:o.enabling},{default:r(()=>e[5]||(e[5]=[f("Enable")])),_:1},8,["disabled"])]),_:1},8,["onConfirmed"]))])]),_:1})}const qo=B(io,[["render",co]]);export{qo as default};
